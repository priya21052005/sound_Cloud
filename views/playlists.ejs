<h2>Your Playlists</h2>

<!-- Button to create new playlist -->
<button id="createPlaylistBtn">+ Create Playlist</button>

<!-- List of existing playlists -->
<div id="playlistsContainer" class="playlists-grid">
  <% if(playlists.length > 0){ %>
    <% playlists.forEach(playlist => { %>
      <div class="playlist-card">
        <div class="playlist-header-bar">
          <h3 class="playlist-card-title">
            <a href="/playlists/view/<%= playlist._id %>"><%= playlist.name %></a>
          </h3>
          <form action="/playlists/<%= playlist._id %>/delete" method="POST" style="display:inline;" onsubmit="return confirm('Delete this playlist?');">
            <button type="submit" class="delete-playlist-btn" title="Delete playlist">üóëÔ∏è</button>
          </form>
        </div>
        
        <% if(playlist.songs.length > 0){ %>
          <p class="song-count"><%= playlist.songs.length %> songs</p>
          <ul class="song-list">
            <% playlist.songs.forEach(song => { %>
              <li class="song-item">
                <span><%= song.title %> - <%= song.artist %></span>
              </li>
            <% }) %>
          </ul>
        <% } else { %>
          <p class="empty-playlist-msg">No songs in this playlist.</p>
        <% } %>
      </div>
    <% }) %>
  <% } else { %>
    <p class="no-playlists-msg">üì≠ No playlists yet. Create one to get started!</p>
  <% } %>
</div>

<!-- Add song to playlist -->
<h3 style="margin-top:40px">Add Songs</h3>
<div class="songs">
  <% if (songs && songs.length > 0) { %>
    <% songs.forEach(song => { %>
      <div class="song" style="border:1px solid #eee; padding:5px; margin:5px 0;">
        <p><%= song.title %> - <%= song.artist %></p>
        <% playlists.forEach(playlist => { %>
          <form action="/playlists/<%= playlist._id %>/add/<%= song._id %>" method="POST">
            <button type="submit">Add to <%= playlist.name %></button>
          </form>
        <% }) %>
      </div>
    <% }) %>
  <% } else { %>
    <p>No songs available</p>
  <% } %>
</div>

<style>
  .playlists-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    margin: 20px 0;
  }

  .playlist-card {
    background: linear-gradient(135deg, #282828 0%, #1a1a1a 100%);
    border: 1px solid rgba(29, 185, 84, 0.2);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
  }

  .playlist-card:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(29, 185, 84, 0.25);
    border-color: rgba(29, 185, 84, 0.4);
    background: linear-gradient(135deg, #333333 0%, #1f1f1f 100%);
  }

  .playlist-header-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    gap: 10px;
  }

  .playlist-card-title {
    margin: 0;
    font-size: 18px;
    font-weight: 700;
    color: #fff;
    flex: 1;
  }

  .playlist-card-title a {
    color: #fff;
    text-decoration: none;
    transition: color 0.3s;
  }

  .playlist-card-title a:hover {
    color: #1db954;
  }

  .delete-playlist-btn {
    background: rgba(255, 70, 70, 0.1);
    border: 1px solid rgba(255, 70, 70, 0.3);
    color: #ff6b6b;
    border-radius: 6px;
    padding: 6px 10px;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s;
    font-weight: 600;
  }

  .delete-playlist-btn:hover {
    background: rgba(255, 70, 70, 0.2);
    border-color: rgba(255, 70, 70, 0.5);
    transform: scale(1.1);
  }

  .delete-playlist-btn:active {
    transform: scale(0.95);
  }

  .song-count {
    font-size: 13px;
    color: #b3b3b3;
    margin: 0 0 10px 0;
  }

  .song-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .song-item {
    padding: 8px;
    margin: 4px 0;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 6px;
    font-size: 13px;
    color: #b3b3b3;
    border-left: 3px solid #1db954;
  }

  .empty-playlist-msg {
    font-size: 13px;
    color: #b3b3b3;
    font-style: italic;
    margin: 0;
  }

  .no-playlists-msg {
    text-align: center;
    padding: 40px;
    color: #b3b3b3;
    font-size: 16px;
  }

  #createPlaylistBtn {
    background: linear-gradient(135deg, #1db954 0%, #1ed760 100%);
    color: #000;
    border: none;
    padding: 12px 24px;
    border-radius: 20px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
    margin-bottom: 20px;
  }

  #createPlaylistBtn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(29, 185, 84, 0.4);
  }

  #createPlaylistBtn:active {
    transform: scale(0.98);
  }

  @media (max-width: 768px) {
    .playlists-grid {
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
    }

    .playlist-card {
      padding: 15px;
    }

    .playlist-card-title {
      font-size: 16px;
    }
  }

  @media (max-width: 480px) {
    .playlists-grid {
      grid-template-columns: 1fr;
    }

    .playlist-card {
      padding: 12px;
    }
  }
</style>

<script>
  // Create Playlist Button Handler
  const createPlaylistBtn = document.getElementById("createPlaylistBtn");
  
  createPlaylistBtn.addEventListener("click", () => {
    const playlistName = prompt("Enter playlist name:");
    
    if (playlistName && playlistName.trim()) {
      // Create a hidden form and submit
      const form = document.createElement("form");
      form.method = "POST";
      form.action = "/playlists";
      
      const nameInput = document.createElement("input");
      nameInput.type = "hidden";
      nameInput.name = "name";
      nameInput.value = playlistName.trim();
      
      form.appendChild(nameInput);
      document.body.appendChild(form);
      form.submit();
    }
  });
</script>
